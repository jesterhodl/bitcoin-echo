CompileFlags:
  Add:
    - -Iinclude
    - -std=c11
    - -pedantic
    - -Wall
    - -Wextra
    - -Werror=implicit-function-declaration
    - -Werror=incompatible-pointer-types
    - -Werror=int-conversion
    - -Wconversion
    - -Wsign-conversion
    - -Wcast-qual
    - -Wcast-align
    - -Wwrite-strings
    - -Wundef
    - -Wshadow
    - -Wstrict-prototypes
    - -Wmissing-prototypes
  Remove:
    - -std=c++*
    - -std=gnu*

Diagnostics:
  UnusedIncludes: Strict
  MissingIncludes: Strict
  # Suppress common noise from system headers
  Suppress:
    - 'bugprone-reserved-identifier'
  ClangTidy:
    Add:
      - bugprone-*
      - cert-*
      - clang-analyzer-*
      - misc-*
      - portability-*
      - readability-identifier-naming
      - readability-magic-numbers
      - readability-simplify-boolean-expr
    Remove:
      - bugprone-easily-swappable-parameters
      - readability-magic-numbers  # We use constants appropriately
      - cert-err33-c  # Too noisy for our use case

Index:
  Background: Build

# clangd include-cleaner on macOS may attribute symbols like pthread_t/socklen_t
# to private system headers (e.g. sys/_pthread/*), producing noisy
# clangd(missing-includes) diagnostics. We keep the source clean and suppress
# MissingIncludes for these translation units instead of including private
# headers.
---
If:
  PathMatch: '(^|.*/)src/platform/posix\.c$'
Diagnostics:
  MissingIncludes: None
---
If:
  PathMatch: '(^|.*/)src/app/log\.c$'
Diagnostics:
  MissingIncludes: None
